<!DOCTYPE html>
<html>
<head>
    <title>Debug Contact Info - Motor Sale</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        button { padding: 10px 15px; margin: 5px; cursor: pointer; }
        .success { color: green; }
        .error { color: red; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Debug Contact Info</h1>
    
    <div class="section">
        <h3>Datos Actuales en localStorage</h3>
        <button onclick="showCurrentData()">Mostrar Datos</button>
        <div id="currentData"></div>
    </div>
    
    <div class="section">
        <h3>Limpiar y Reinicializar</h3>
        <button onclick="clearAndReinit()">Limpiar Todo y Reinicializar</button>
        <div id="clearStatus"></div>
    </div>
    
    <div class="section">
        <h3>Cambiar Número de Prueba</h3>
        <input type="text" id="newPhone" placeholder="+56912345678" value="+56912345678">
        <button onclick="updatePhone()">Actualizar Teléfono</button>
        <div id="updateStatus"></div>
    </div>
    
    <div class="section">
        <h3>Verificar EventBus</h3>
        <button onclick="testEventBus()">Probar Eventos</button>
        <div id="eventStatus"></div>
    </div>

    <script>
        function showCurrentData() {
            const contact = localStorage.getItem('motorsale_contact_info');
            const vehicles = localStorage.getItem('motorsale_vehicles');
            
            document.getElementById('currentData').innerHTML = `
                <h4>Contacto:</h4>
                <pre>${contact ? JSON.stringify(JSON.parse(contact), null, 2) : 'No hay datos'}</pre>
                <h4>Vehículos:</h4>
                <pre>${vehicles ? `${JSON.parse(vehicles).length} vehículos encontrados` : 'No hay datos'}</pre>
            `;
        }
        
        function clearAndReinit() {
            localStorage.clear();
            
            // Reinicializar con datos por defecto
            const defaultContact = {
                phone: '+56912345678',
                email: 'contacto@motorsale.cl',
                whatsapp: '+56912345678',
                address: 'Av. Buin 1234',
                city: 'Buin',
                region: 'Región Metropolitana',
                country: 'Chile',
                businessHours: {
                    monday: { open: '09:00', close: '18:00' },
                    tuesday: { open: '09:00', close: '18:00' },
                    wednesday: { open: '09:00', close: '18:00' },
                    thursday: { open: '09:00', close: '18:00' },
                    friday: { open: '09:00', close: '18:00' },
                    saturday: { open: '09:00', close: '14:00' },
                    sunday: { open: '10:00', close: '14:00', closed: true }
                },
                socialMedia: {
                    facebook: 'https://facebook.com/motorsale',
                    instagram: 'https://instagram.com/motorsale'
                },
                companyName: 'Motor Sale',
                companyDescription: 'Tu concesionaria de confianza en Buin.',
                metaTitle: 'Motor Sale - Compra y Venta de Vehículos en Buin',
                metaDescription: 'Encuentra el auto perfecto en Motor Sale.',
                updatedAt: new Date().toISOString()
            };
            
            localStorage.setItem('motorsale_contact_info', JSON.stringify(defaultContact));
            
            document.getElementById('clearStatus').innerHTML = '<p class="success">✅ Datos limpiados y reinicializados con número +56912345678</p>';
        }
        
        function updatePhone() {
            const newPhone = document.getElementById('newPhone').value;
            if (!newPhone) {
                document.getElementById('updateStatus').innerHTML = '<p class="error">❌ Ingresa un número válido</p>';
                return;
            }
            
            const contact = JSON.parse(localStorage.getItem('motorsale_contact_info') || '{}');
            contact.phone = newPhone;
            contact.whatsapp = newPhone;
            contact.updatedAt = new Date().toISOString();
            
            localStorage.setItem('motorsale_contact_info', JSON.stringify(contact));
            
            // Simular evento
            window.dispatchEvent(new CustomEvent('storage', {
                detail: { key: 'motorsale_contact_info', newValue: JSON.stringify(contact) }
            }));
            
            document.getElementById('updateStatus').innerHTML = `<p class="success">✅ Número actualizado a ${newPhone}</p>`;
        }
        
        function testEventBus() {
            // Simular cambio y evento
            const contact = JSON.parse(localStorage.getItem('motorsale_contact_info') || '{}');
            contact.phone = '+56999888777';
            contact.whatsapp = '+56999888777';
            contact.updatedAt = new Date().toISOString();
            
            localStorage.setItem('motorsale_contact_info', JSON.stringify(contact));
            
            document.getElementById('eventStatus').innerHTML = '<p class="success">✅ Evento de prueba enviado con número +56999888777</p>';
        }
        
        // Auto-mostrar datos al cargar
        window.onload = function() {
            showCurrentData();
        }
    </script>
</body>
</html>
